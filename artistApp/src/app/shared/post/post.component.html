<div class="card border-0 p-0" *ngIf="post">
  <!-- Contenitore con aspect ratio fissa -->
  <div class="position-relative">
    <h6 class="card-title ms-2 mt-1">
      {{ post.title }}
    </h6>
    <!-- Wrapper per mantenere aspect ratio 4:3 -->
    <div class="position-relative card-height">
      <img
        (click)="getComments(post.id)"
        class="position-absolute top-0 start-0 w-100 h-100 rounded-bottom-2 object-fit-cover"
        [src]="post.imageUrl"
        [alt]="post.title"
        (click)="isCollapsed = !isCollapsed"
      />
    </div>
  </div>

  <div #collapse="ngbCollapse" [(ngbCollapse)]="isCollapsed">
    <div class="card-body p-0 mt-2 mx-2">
      <div>
        <span
          class="tastoUsername text-primary"
          (click)="navigateToArtist(post.user.id)"
        >
          {{ post.user.userName }}
        </span>
        <span>&#8226; {{ post.caption }}</span>
      </div>
      <p>{{ post.date | date }}</p>
      <div class="d-flex py-2 justify-content-start">
        <a
          (click)="addToFavorites(post)"
          class="btn btn-link text-danger border-0 p-0"
          ><i
            class="bi me-2"
            [ngClass]="isFavorite(post) ? 'bi-heart-fill' : 'bi-heart'"
          ></i
        ></a>
        <a (click)="showComments()"
          ><i class="bi bi-chat-left-text icon text-info-emphasis"></i
        ></a>
      </div>
    </div>
  </div>
</div>

<div #collapse="ngbCollapse" [(ngbCollapse)]="isVisible">
  <div class="bg-white rounded-2">
    <app-comment-input
      [postId]="post.id"
      (commentSubmitted)="comments.push($event)"
    ></app-comment-input>
  </div>
  <div class="bg-white rounded-2" *ngFor="let comment of comments">
    <app-comment
      (commentDeleted)="deleteComment($event)"
      (commentUpdated)="updateComment($event)"
      [comment]="comment"
    ></app-comment>
  </div>
</div>
